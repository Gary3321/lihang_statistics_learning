
![大纲](/pictures/perceptron-outline.png)
类似于线性模型； 分错的点与直线距离求和，求和距离最小的直线是好的直线。（损失函数）
- 一条直线不分错一个点，这就是好的直线。
- 模型要尽可能找到好的直线。
- 如果没有好的直线，在差的直线中找到较好的直线。
- 判断直线好坏的方式：分错的点到直线的距离求和。

## 感知机
前提：数据集要线性可分性。

![perceptron_example](/pictures/perceptron_example.png)
目标： 学习 f(x)

f(x) = sign(w.x + b)

sign(x) =
$\begin{cases}
+1, & x\ge0 \\
-1, & x<0
\end{cases}$

w.x + b 是那个超平面 (知识点：高数-->平面)；超平面的维度依赖于特征空间的维度 （D),一般为D-1维。

2-d 平面 --> 1-d 线划分

3-d 空间 --> 2-d 平面
。。

w.x + b 是一个n维空间的超平面S，将特征空间划分为两部分。其中w为超平面的法向量，b是超平面的截距。

### 空间点到超平面S的距离：
- 函数间距： $|w.x_0 + b|$ （为啥是$x_0$到w.x+b平面的距离呢？$x_0$ 不在平面上呀？） 一个问题：等值缩小w 和b，平面不变但点到S的函数间距也等值缩小了！！
- 几何间距 （被使用）：$\frac{1}{||w||}|w.x_0 + b|$, 解决了函数间距的那个问题。

几何间距就是点到直线的距离([here](https://www.zhihu.com/question/20466147), 函数间距就是为归一化的几何间距。

### 感知机的学习算法 -- 原始形式
对于误分类数据而言： $-y_i(w.x_i + b)>0$ (因为误分类数据意味着$y_i$和$w.x_i+b$的符号不同)

误分类点$x_i$到超平面S的距离为：$-\frac{1}{||w||}y_i(w.x_i + b)$ （不需要绝对值，因为是正数).

因此，所有误分类点到S的总距离为：$-\frac{1}{||w||}\sum_{x_i\in M}y_i(w.x_i + b)$ (M:误分类的点的集合)

**为什么距离是 $-y_i(w.x_i + b)$, 而不是 |$w.x_i + b$| ?**

答： 如果只考虑误分类数据，这两个式子是相等的。因为 y = {-1, +1}, 所以 对误分类数据而言，$-y_i(w.x_i + b)$ 恒大于0。感知机是误分类驱动的，也就是说只对误分类数据计算距离的。所以距离用$-y_i(w.x_i + b)$表示。



损失函数： L(w,b) = $-\sum_{x_i\in M}y_i(w.x_i + b)$ （感知机的目标是最终没有误分类的点，也就是说损失函数最终为0，所以这里用的是函数间距。）

这个函数只是针对误分类的点的（需要先判断点是否被误分类）。

#### learning policy
- 任选取超平面 $w_0, b_0$
- 采用梯度下降法极小化目标函数
  - L(w,b) = $-\sum_{x_i\in M}y_i(w.x_i + b)$
  - $\nabla_{w}$ L(w,b) = $-\sum_{x_i\in M}(y_i.x_i)$
  - $\nabla_{w}$ L(w,b) = $-\sum_{x_i\in M}y_i$
- 更新w, b (对每个误分类点更新一次)
  - w <- w + $\alpha * (y_ix_i)$
  - b <- b + $\alpha y_i$

![作业](/pictures/perceptron-homework.png)

![伪代码](/pictures/perceptron-seducode.png)

## 对偶形式 （另一种方法求解）
使算法更简单 （空间，时间维度）
- $\alpha$ 比 w 简单
- gram 矩阵

## 收敛性证明
证明感知机有效，及在什么条件下有效。
$||w||=(w_1^2 + w_2^2 + ...)^{1/2}$
- 要求 数据集线性可分
- 证明感知机**误分类次数**是有上界的，说明通过有限次搜索可以找到将数据集完全正确分开的分离超平面。
- 当数据集线性不可分时，感知机算法不收敛，会发生震荡。


## 总结
- 感知机通过构造超平面的形式划分二分类的点。
- 感知机属于线性判别模型，因为它的判别边界是线性的。
- 感知机使用的是函数间隔，因为它是基于误分类驱动的，也就是说最终间隔为0 (没有误分类的点)


***读书太少而想太多*： 自己有很多疑问是因为paper读少了，对自己的许多想法别人都可能发paper阐述过。因此刚入门一个行业，要多读paper多了解这个行业，不要闭门造车。
